"use strict";(self.webpackChunkargon_dashboard_angular=self.webpackChunkargon_dashboard_angular||[]).push([[244],{5244:(b,g,s)=>{s.r(g),s.d(g,{BilansModule:()=>x});var c=s(6895),m=s(3060),h=s(8670),f=s(4327),d=s(136),e=s(4650),l=s(4463),u=s(3986),C=s(9359),E=s(1424),T=s(2953),v=s(7009),p=s(4006),y=s(4424);const B=["f"];function F(i,r){1&i&&(e.TgZ(0,"div",20),e._uU(1," Code est requis. "),e.qZA())}function L(i,r){1&i&&(e.TgZ(0,"div",20),e._uU(1," Nom est requis. "),e.qZA())}function Z(i,r){if(1&i&&(e.TgZ(0,"option",21),e._uU(1),e.qZA()),2&i){const n=r.$implicit;e.Q6J("value",n),e.xp6(1),e.Oqu(n)}}function A(i,r){1&i&&(e.TgZ(0,"div",20),e._uU(1," Type est requis. "),e.qZA())}let M=(()=>{class i{constructor(n,t,o){this.bilansService=n,this.modalService=t,this._snackBar=o,this.title=d._G.BILANS,this.isLoading=!1,this.horizontalPosition="end",this.verticalPosition="bottom",this.types=d.kH,this.closingEvent=new e.vpe,this.reloadEvent=new e.vpe}ngOnInit(){this.title=(this.selectedElement?d._G.UPDATE_ELEMENT:d._G.CREATE_ELEMENT)+" "+this.title,this.data={type:this.selectedElement?this.selectedElement.type:"",code:this.selectedElement?this.selectedElement.code:"",name:this.selectedElement?this.selectedElement.name:"",enabled:!this.selectedElement||this.selectedElement.enabled}}onClose(){this.closingEvent.emit()}toggleStatus(){this.data.enabled=!this.data.enabled}onSubmit(){const n=Object.values(this.form.controls);for(let t of n)if(t.invalid)return;this.isLoading=!0,this.selectedElement?this.bilansService.update(this.selectedElement.id,this.data).subscribe(t=>{this.onSuccess(t)},t=>{this.onError(t)}):this.bilansService.create(this.data).subscribe(t=>{this.onSuccess(t)},t=>{this.onError(t)})}onSuccess(n){this.isLoading=!1,this.reloadEvent.emit(),this.modalService.dismissAll(),this._snackBar.open("Enregistr\xe9 avec succ\xe8s!","Ok",{horizontalPosition:this.horizontalPosition,verticalPosition:this.verticalPosition,panelClass:["success-snackbar"]})}onError(n){this.isLoading=!1;let t=n.error.data;for(let o in t)this._snackBar.open(t[o],"Ok",{horizontalPosition:this.horizontalPosition,verticalPosition:this.verticalPosition,panelClass:["danger-snackbar"]})}}return i.\u0275fac=function(n){return new(n||i)(e.Y36(h.p),e.Y36(T.FF),e.Y36(v.ux))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-bilans-form"]],viewQuery:function(n,t){if(1&n&&e.Gf(B,5),2&n){let o;e.iGM(o=e.CRH())&&(t.form=o.first)}},inputs:{selectedElement:"selectedElement"},outputs:{closingEvent:"closingEvent",reloadEvent:"reloadEvent"},decls:29,vars:10,consts:[[3,"title","isLoading","closingEvent","submit"],["f","ngForm"],[1,"row"],[1,"col-md-6"],[1,"form-group"],["type","text","name","code","required","","placeholder","Code",1,"form-control","form-control-alternative",3,"ngModel","ngModelChange"],["code","ngModel"],["class","error-message",4,"ngIf"],["type","text","name","name","required","","placeholder","Nom",1,"form-control","form-control-alternative",3,"ngModel","ngModelChange"],["name","ngModel"],["name","type","required","","placeholder","Type",1,"form-control","form-control-alternative",3,"ngModel","ngModelChange"],["type","ngModel"],["value","","disabled",""],[3,"value",4,"ngFor","ngForOf"],[1,"col-md-6","d-flex","align-items-center"],[1,"form-group","d-flex","mb-0"],[1,"mr-2"],[1,"custom-toggle","mb-0"],["type","checkbox",3,"checked","click"],[1,"custom-toggle-slider","rounded-circle"],[1,"error-message"],[3,"value"]],template:function(n,t){if(1&n&&(e.TgZ(0,"app-base-modal",0),e.NdJ("closingEvent",function(){return t.onClose()})("submit",function(){return t.onSubmit()}),e.TgZ(1,"form",null,1)(3,"div",2)(4,"div",3)(5,"div",4)(6,"input",5,6),e.NdJ("ngModelChange",function(a){return t.data.code=a}),e.qZA(),e.YNc(8,F,2,0,"div",7),e.qZA()(),e.TgZ(9,"div",3)(10,"div",4)(11,"input",8,9),e.NdJ("ngModelChange",function(a){return t.data.name=a}),e.qZA(),e.YNc(13,L,2,0,"div",7),e.qZA()(),e.TgZ(14,"div",3)(15,"div",4)(16,"select",10,11),e.NdJ("ngModelChange",function(a){return t.data.type=a}),e.TgZ(18,"option",12),e._uU(19,"Type"),e.qZA(),e.YNc(20,Z,2,2,"option",13),e.qZA(),e.YNc(21,A,2,0,"div",7),e.qZA()(),e.TgZ(22,"div",14)(23,"div",15)(24,"span",16),e._uU(25,"Enabled:"),e.qZA(),e.TgZ(26,"label",17)(27,"input",18),e.NdJ("click",function(){return t.toggleStatus()}),e.qZA(),e._UZ(28,"span",19),e.qZA()()()()()()),2&n){const o=e.MAs(7),a=e.MAs(12),_=e.MAs(17);e.Q6J("title",t.title)("isLoading",t.isLoading),e.xp6(6),e.Q6J("ngModel",t.data.code),e.xp6(2),e.Q6J("ngIf",o.invalid&&o.touched),e.xp6(3),e.Q6J("ngModel",t.data.name),e.xp6(2),e.Q6J("ngIf",a.invalid&&a.touched),e.xp6(3),e.Q6J("ngModel",t.data.type),e.xp6(4),e.Q6J("ngForOf",t.types),e.xp6(1),e.Q6J("ngIf",_.invalid&&_.touched),e.xp6(6),e.Q6J("checked",t.data.enabled)}},dependencies:[c.sg,c.O5,p._Y,p.YN,p.Kr,p.Fj,p.EJ,p.JJ,p.JL,p.Q7,p.On,p.F,y.u]}),i})();function S(i,r){if(1&i){const n=e.EpF();e.TgZ(0,"app-bilans-form",16),e.NdJ("closingEvent",function(){e.CHM(n);const o=e.oxw();return e.KtG(o.onClose())})("reloadEvent",function(){e.CHM(n);const o=e.oxw();return e.KtG(o.onFormReload())}),e.qZA()}if(2&i){const n=e.oxw();e.Q6J("id",n.selectedElement)("selectedElement",n.selectedElement)}}const J=[{path:"",component:(()=>{class i{constructor(n,t){this.bilansService=n,this.translate=t,this.data=[],this.isShowForm=!1,this.selectedElement=null,this.page=1,this.pagesCount=1,this.isLoading=!0,this.tableData=[{header:"Id",key:"id",type:"text"},{header:"Nom",key:"name",type:"text"},{header:"Code",key:"code",type:"text"},{header:"Type",key:"type",type:"text"},{header:"Date de cr\xe9ation",key:"created_at",type:"date"},{header:"Date de modification",key:"updated_at",type:"date"},{header:"Status",key:"enabled",type:"status"}],this.filters={type:"",code:"",name:"",id:""},this.filtersElements=[{type:"number",name:"id",title:"ID",value:""},{type:"text",name:"code",title:"Code",value:""},{type:"text",name:"name",title:"Nom",value:""},{type:"select",name:"type",title:"Type",value:"",elements:d.kH},{type:"status",name:"enabled",title:"Activ\xe9",value:""}]}ngOnInit(){this.onLoad()}onAdd(){this.isShowForm=!0}onClose(){this.isShowForm=!1,this.selectedElement=!1}onFormReload(){this.onClose(),this.onLoad()}toggleStatusChange(n){console.log(n.status,n.id),this.isLoading=!0,this.bilansService.status(n.id,{enabled:n.status}).subscribe(t=>{let o=this.data.findIndex(a=>a.id===n.id);o>=0&&(this.data[o].enabled=t.data.enabled),this.isLoading=!1})}onEdit(n){this.isShowForm=!0,this.selectedElement=n}onPageChange(n){console.log(n),this.page=n,this.onLoad()}onLoad(){this.isLoading=!0;let n=this.getFilters();console.log(n),this.bilansService.all({params:n}).subscribe(t=>{console.log(t),this.data=t.data.data,this.pagesCount=t.data.last_page,this.isLoading=!1},t=>{this.isLoading=!1})}exportData(){this.isLoading=!0;let n=this.getFilters(!0);this.bilansService.all({params:n,responseType:"blob"}).subscribe(t=>{console.log(t);const o=new Blob([t],{type:"text/csv"});(0,f.saveAs)(o,"bilans.csv"),this.isLoading=!1},t=>{console.log(t),this.isLoading=!1})}getFilters(n=!1){let t={};for(let o in this.filters)this.filters[o]&&""!=this.filters[o]&&(t[o]=this.filters[o]);return t.page=this.page,t.limit=15,n&&(t.export=!0),t}onFiltersChange(n){this.filters={...n},this.onLoad()}}return i.\u0275fac=function(n){return new(n||i)(e.Y36(h.p),e.Y36(l.sK))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-bilans-list"]],decls:19,vars:7,consts:[[1,"header","bg-gradient-info","pb-8","pt-5","pt-md-8"],[1,"container-fluid"],[1,"header-body"],[1,"container-fluid","mt--7"],[1,"row"],[1,"col"],[1,"card","shadow"],[1,"card-header","border-0","d-flex"],[1,"mb-0"],[1,"ml-auto"],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-success","ml-2",3,"click"],[3,"filters","onFilterChange"],[3,"tableData","data","isLoading","onEdit","onToggleStatus"],[3,"page","pagesCount","onPageChange"],[3,"id","selectedElement","closingEvent","reloadEvent",4,"ngIf"],[3,"id","selectedElement","closingEvent","reloadEvent"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0)(1,"div",1),e._UZ(2,"div",2),e.qZA()(),e.TgZ(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"h3",8),e._uU(9,"ANTECEDENTS"),e.qZA(),e.TgZ(10,"div",9)(11,"button",10),e.NdJ("click",function(){return t.onAdd()}),e._uU(12," Ajouter "),e.qZA(),e.TgZ(13,"button",11),e.NdJ("click",function(){return t.exportData()}),e._uU(14," Export "),e.qZA()()(),e.TgZ(15,"app-base-filter",12),e.NdJ("onFilterChange",function(a){return t.onFiltersChange(a)}),e.qZA(),e.TgZ(16,"app-base-table",13),e.NdJ("onEdit",function(a){return t.onEdit(a)})("onToggleStatus",function(a){return t.toggleStatusChange(a)}),e.qZA(),e.TgZ(17,"app-pagination-links",14),e.NdJ("onPageChange",function(a){return t.onPageChange(a)}),e.qZA()()()()(),e.YNc(18,S,1,2,"app-bilans-form",15)),2&n&&(e.xp6(15),e.Q6J("filters",t.filtersElements),e.xp6(1),e.Q6J("tableData",t.tableData)("data",t.data)("isLoading",t.isLoading),e.xp6(1),e.Q6J("page",t.page)("pagesCount",t.pagesCount),e.xp6(1),e.Q6J("ngIf",t.isShowForm))},dependencies:[c.O5,u.N,C.K,E.C,M]}),i})()}];let N=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[m.Bz.forChild(J),m.Bz]}),i})();var P=s(5642),k=s(529);let x=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[c.ez,N,P.K,k.JF,p.u5,l.aw,v.ZX]}),i})()},8670:(b,g,s)=>{s.d(g,{p:()=>f});var c=s(2340),m=s(4650),h=s(529);let f=(()=>{class d{constructor(l){this.http=l}all(l){return this.http.get(`${c.N.url}/api/bilans`,l)}update(l,u){return this.http.put(`${c.N.url}/api/bilans/${l}`,u)}create(l){return this.http.post(`${c.N.url}/api/bilans`,l)}status(l,u){return this.http.put(`${c.N.url}/api/bilans/status/${l}`,u)}find(l){return this.http.get(`${c.N.url}/api/bilans/${l}`)}}return d.\u0275fac=function(l){return new(l||d)(m.LFG(h.eN))},d.\u0275prov=m.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"}),d})()}}]);