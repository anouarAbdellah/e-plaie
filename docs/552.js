"use strict";(self.webpackChunkargon_dashboard_angular=self.webpackChunkargon_dashboard_angular||[]).push([[552],{552:(M,u,s)=>{s.r(u),s.d(u,{MotifsModule:()=>O});var p=s(6895),c=s(3060),g=s(5799),h=s(4327),d=s(136),t=s(4650),l=s(4463),f=s(3986),C=s(9359),E=s(1424),b=s(2953),v=s(7009),T=s(4424),m=s(4006);const y=["f"];function F(n,r){1&n&&(t.TgZ(0,"div",20),t._uU(1," Code est requis. "),t.qZA())}function L(n,r){1&n&&(t.TgZ(0,"div",20),t._uU(1," Nom est requis. "),t.qZA())}function Z(n,r){if(1&n&&(t.TgZ(0,"option",21),t._uU(1),t.qZA()),2&n){const o=r.$implicit;t.Q6J("value",o),t.xp6(1),t.Oqu(o)}}function A(n,r){1&n&&(t.TgZ(0,"div",20),t._uU(1," Type est requis. "),t.qZA())}let S=(()=>{class n{constructor(o,e,i){this.motifsService=o,this.modalService=e,this._snackBar=i,this.title=d._G.MOTIFS,this.isLoading=!1,this.horizontalPosition="end",this.verticalPosition="bottom",this.types=d.px,this.closingEvent=new t.vpe,this.reloadEvent=new t.vpe}ngOnInit(){this.title=(this.selectedElement?d._G.UPDATE_ELEMENT:d._G.CREATE_ELEMENT)+" "+this.title,this.data={type:this.selectedElement?this.selectedElement.type:"",code:this.selectedElement?this.selectedElement.code:"",name:this.selectedElement?this.selectedElement.name:"",enabled:!this.selectedElement||this.selectedElement.enabled}}onClose(){this.closingEvent.emit()}toggleStatus(){this.data.enabled=!this.data.enabled}onSubmit(){const o=Object.values(this.form.controls);for(let e of o)if(e.invalid)return;this.isLoading=!0,this.selectedElement?this.motifsService.update(this.selectedElement.id,this.data).subscribe(e=>{this.onSuccess(e)},e=>{this.onError(e)}):this.motifsService.create(this.data).subscribe(e=>{this.onSuccess(e)},e=>{this.onError(e)})}onSuccess(o){this.isLoading=!1,this.reloadEvent.emit(),this.modalService.dismissAll(),this._snackBar.open("Enregistr\xe9 avec succ\xe8s!","Ok",{horizontalPosition:this.horizontalPosition,verticalPosition:this.verticalPosition,panelClass:["success-snackbar"]})}onError(o){this.isLoading=!1;let e=o.error.data;for(let i in e)this._snackBar.open(e[i],"Ok",{horizontalPosition:this.horizontalPosition,verticalPosition:this.verticalPosition,panelClass:["danger-snackbar"]})}}return n.\u0275fac=function(o){return new(o||n)(t.Y36(g.k),t.Y36(b.FF),t.Y36(v.ux))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-motifs-form"]],viewQuery:function(o,e){if(1&o&&t.Gf(y,5),2&o){let i;t.iGM(i=t.CRH())&&(e.form=i.first)}},inputs:{selectedElement:"selectedElement"},outputs:{closingEvent:"closingEvent",reloadEvent:"reloadEvent"},decls:29,vars:10,consts:[[3,"title","isLoading","closingEvent","submit"],["f","ngForm"],[1,"row"],[1,"col-md-6"],[1,"form-group"],["type","text","name","code","required","","placeholder","Code",1,"form-control","form-control-alternative",3,"ngModel","ngModelChange"],["code","ngModel"],["class","error-message",4,"ngIf"],["type","text","name","name","required","","placeholder","Nom",1,"form-control","form-control-alternative",3,"ngModel","ngModelChange"],["name","ngModel"],["name","type","required","","placeholder","Type",1,"form-control","form-control-alternative",3,"ngModel","ngModelChange"],["type","ngModel"],["value","","disabled",""],[3,"value",4,"ngFor","ngForOf"],[1,"col-md-6","d-flex","align-items-center"],[1,"form-group","d-flex","mb-0"],[1,"mr-2"],[1,"custom-toggle","mb-0"],["type","checkbox",3,"checked","click"],[1,"custom-toggle-slider","rounded-circle"],[1,"error-message"],[3,"value"]],template:function(o,e){if(1&o&&(t.TgZ(0,"app-base-modal",0),t.NdJ("closingEvent",function(){return e.onClose()})("submit",function(){return e.onSubmit()}),t.TgZ(1,"form",null,1)(3,"div",2)(4,"div",3)(5,"div",4)(6,"input",5,6),t.NdJ("ngModelChange",function(a){return e.data.code=a}),t.qZA(),t.YNc(8,F,2,0,"div",7),t.qZA()(),t.TgZ(9,"div",3)(10,"div",4)(11,"input",8,9),t.NdJ("ngModelChange",function(a){return e.data.name=a}),t.qZA(),t.YNc(13,L,2,0,"div",7),t.qZA()(),t.TgZ(14,"div",3)(15,"div",4)(16,"select",10,11),t.NdJ("ngModelChange",function(a){return e.data.type=a}),t.TgZ(18,"option",12),t._uU(19,"Type"),t.qZA(),t.YNc(20,Z,2,2,"option",13),t.qZA(),t.YNc(21,A,2,0,"div",7),t.qZA()(),t.TgZ(22,"div",14)(23,"div",15)(24,"span",16),t._uU(25,"Enabled:"),t.qZA(),t.TgZ(26,"label",17)(27,"input",18),t.NdJ("click",function(){return e.toggleStatus()}),t.qZA(),t._UZ(28,"span",19),t.qZA()()()()()()),2&o){const i=t.MAs(7),a=t.MAs(12),_=t.MAs(17);t.Q6J("title",e.title)("isLoading",e.isLoading),t.xp6(6),t.Q6J("ngModel",e.data.code),t.xp6(2),t.Q6J("ngIf",i.invalid&&i.touched),t.xp6(3),t.Q6J("ngModel",e.data.name),t.xp6(2),t.Q6J("ngIf",a.invalid&&a.touched),t.xp6(3),t.Q6J("ngModel",e.data.type),t.xp6(4),t.Q6J("ngForOf",e.types),t.xp6(1),t.Q6J("ngIf",_.invalid&&_.touched),t.xp6(6),t.Q6J("checked",e.data.enabled)}},dependencies:[p.sg,p.O5,T.u,m._Y,m.YN,m.Kr,m.Fj,m.EJ,m.JJ,m.JL,m.Q7,m.On,m.F]}),n})();function J(n,r){if(1&n){const o=t.EpF();t.TgZ(0,"app-motifs-form",16),t.NdJ("closingEvent",function(){t.CHM(o);const i=t.oxw();return t.KtG(i.onClose())})("reloadEvent",function(){t.CHM(o);const i=t.oxw();return t.KtG(i.onFormReload())}),t.qZA()}if(2&n){const o=t.oxw();t.Q6J("id",o.selectedElement)("selectedElement",o.selectedElement)}}const N=[{path:"",component:(()=>{class n{constructor(o,e){this.motifsService=o,this.translate=e,this.data=[],this.isShowForm=!1,this.selectedElement=null,this.page=1,this.pagesCount=1,this.isLoading=!0,this.tableData=[{header:"Id",key:"id",type:"text"},{header:"Nom",key:"name",type:"text"},{header:"Code",key:"code",type:"text"},{header:"Type",key:"type",type:"text"},{header:"Date de cr\xe9ation",key:"created_at",type:"date"},{header:"Date de modification",key:"updated_at",type:"date"},{header:"Status",key:"enabled",type:"status"}],this.filters={type:"",code:"",name:"",id:""},this.filtersElements=[{type:"number",name:"id",title:"ID",value:""},{type:"text",name:"code",title:"Code",value:""},{type:"text",name:"name",title:"Nom",value:""},{type:"select",name:"type",title:"Type",value:"",elements:d.px},{type:"status",name:"enabled",title:"Activ\xe9",value:""}]}ngOnInit(){this.onLoad()}onAdd(){this.isShowForm=!0}onClose(){this.isShowForm=!1,this.selectedElement=!1}onFormReload(){this.onClose(),this.onLoad()}toggleStatusChange(o){console.log(o.status,o.id),this.isLoading=!0,this.motifsService.status(o.id,{enabled:o.status}).subscribe(e=>{let i=this.data.findIndex(a=>a.id===o.id);i>=0&&(this.data[i].enabled=e.data.enabled),this.isLoading=!1})}onEdit(o){this.isShowForm=!0,this.selectedElement=o}onPageChange(o){console.log(o),this.page=o,this.onLoad()}onLoad(){this.isLoading=!0;let o=this.getFilters();console.log(o),this.motifsService.all({params:o}).subscribe(e=>{console.log(e),this.data=e.data.data,this.pagesCount=e.data.last_page,this.isLoading=!1},e=>{this.isLoading=!1})}exportData(){this.isLoading=!0;let o=this.getFilters(!0);this.motifsService.all({params:o,responseType:"blob"}).subscribe(e=>{console.log(e);const i=new Blob([e],{type:"text/csv"});(0,h.saveAs)(i,"motifs.csv"),this.isLoading=!1},e=>{console.log(e),this.isLoading=!1})}getFilters(o=!1){let e={};for(let i in this.filters)this.filters[i]&&""!=this.filters[i]&&(e[i]=this.filters[i]);return e.page=this.page,e.limit=15,o&&(e.export=!0),e}onFiltersChange(o){this.filters={...o},this.onLoad()}}return n.\u0275fac=function(o){return new(o||n)(t.Y36(g.k),t.Y36(l.sK))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-motifs-list"]],decls:19,vars:7,consts:[[1,"header","bg-gradient-info","pb-8","pt-5","pt-md-8"],[1,"container-fluid"],[1,"header-body"],[1,"container-fluid","mt--7"],[1,"row"],[1,"col"],[1,"card","shadow"],[1,"card-header","border-0","d-flex"],[1,"mb-0"],[1,"ml-auto"],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-success","ml-2",3,"click"],[3,"filters","onFilterChange"],[3,"tableData","data","isLoading","onEdit","onToggleStatus"],[3,"page","pagesCount","onPageChange"],[3,"id","selectedElement","closingEvent","reloadEvent",4,"ngIf"],[3,"id","selectedElement","closingEvent","reloadEvent"]],template:function(o,e){1&o&&(t.TgZ(0,"div",0)(1,"div",1),t._UZ(2,"div",2),t.qZA()(),t.TgZ(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"h3",8),t._uU(9,"MOTIFS"),t.qZA(),t.TgZ(10,"div",9)(11,"button",10),t.NdJ("click",function(){return e.onAdd()}),t._uU(12," Ajouter "),t.qZA(),t.TgZ(13,"button",11),t.NdJ("click",function(){return e.exportData()}),t._uU(14," Export "),t.qZA()()(),t.TgZ(15,"app-base-filter",12),t.NdJ("onFilterChange",function(a){return e.onFiltersChange(a)}),t.qZA(),t.TgZ(16,"app-base-table",13),t.NdJ("onEdit",function(a){return e.onEdit(a)})("onToggleStatus",function(a){return e.toggleStatusChange(a)}),t.qZA(),t.TgZ(17,"app-pagination-links",14),t.NdJ("onPageChange",function(a){return e.onPageChange(a)}),t.qZA()()()()(),t.YNc(18,J,1,2,"app-motifs-form",15)),2&o&&(t.xp6(15),t.Q6J("filters",e.filtersElements),t.xp6(1),t.Q6J("tableData",e.tableData)("data",e.data)("isLoading",e.isLoading),t.xp6(1),t.Q6J("page",e.page)("pagesCount",e.pagesCount),t.xp6(1),t.Q6J("ngIf",e.isShowForm))},dependencies:[p.O5,f.N,C.K,E.C,S]}),n})()}];let P=(()=>{class n{}return n.\u0275fac=function(o){return new(o||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[c.Bz.forChild(N),c.Bz]}),n})();var k=s(5642),x=s(529);let O=(()=>{class n{}return n.\u0275fac=function(o){return new(o||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[p.ez,P,k.K,x.JF,m.u5,l.aw,v.ZX]}),n})()},5799:(M,u,s)=>{s.d(u,{k:()=>h});var p=s(2340),c=s(4650),g=s(529);let h=(()=>{class d{constructor(l){this.http=l}all(l){return this.http.get(`${p.N.url}/api/motifs`,l)}update(l,f){return this.http.put(`${p.N.url}/api/motifs/${l}`,f)}create(l){return this.http.post(`${p.N.url}/api/motifs`,l)}status(l,f){return this.http.put(`${p.N.url}/api/motifs/status/${l}`,f)}find(l){return this.http.get(`${p.N.url}/api/motifs/${l}`)}}return d.\u0275fac=function(l){return new(l||d)(c.LFG(g.eN))},d.\u0275prov=c.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"}),d})()}}]);