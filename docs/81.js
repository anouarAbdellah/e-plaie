"use strict";(self.webpackChunkargon_dashboard_angular=self.webpackChunkargon_dashboard_angular||[]).push([[81],{1081:(he,M,a)=>{a.r(M),a.d(M,{CustomModulesModule:()=>ge});var c=a(6895),g=a(3060),p=a(2917),T=a(4327),e=a(4650),C=a(4463),F=a(3986),Z=a(9359),b=a(1424),E=a(2953),h=a(7009),w=a(4424),_=a(4006),u=a(9549),x=a(4144),v=a(5113),J=a(3238);const y=["f"];function N(i,d){if(1&i){const t=e.EpF();e.TgZ(0,"mat-form-field",8)(1,"mat-label"),e._uU(2),e.qZA(),e.TgZ(3,"input",9),e.NdJ("ngModelChange",function(n){e.CHM(t);const s=e.oxw().$implicit,l=e.oxw();return e.KtG(l.data[s.id]=n)}),e.qZA()()}if(2&i){const t=e.oxw().$implicit,o=e.oxw();e.xp6(2),e.Oqu(t.name),e.xp6(1),e.s9C("placeholder",t.name),e.Q6J("name",t.id)("required",t.is_required)("ngModel",o.data[t.id])}}function k(i,d){if(1&i){const t=e.EpF();e.TgZ(0,"mat-form-field",8)(1,"mat-label"),e._uU(2),e.qZA(),e.TgZ(3,"textarea",9),e.NdJ("ngModelChange",function(n){e.CHM(t);const s=e.oxw().$implicit,l=e.oxw();return e.KtG(l.data[s.id]=n)}),e.qZA()()}if(2&i){const t=e.oxw().$implicit,o=e.oxw();e.xp6(2),e.Oqu(t.name),e.xp6(1),e.s9C("placeholder",t.name),e.Q6J("name",t.id)("required",t.is_required)("ngModel",o.data[t.id])}}function L(i,d){if(1&i&&(e.TgZ(0,"mat-option",12),e._uU(1),e.qZA()),2&i){const t=d.$implicit;e.Q6J("value",t.value),e.xp6(1),e.Oqu(t.value)}}function O(i,d){if(1&i){const t=e.EpF();e.TgZ(0,"mat-form-field",8)(1,"mat-label"),e._uU(2),e.qZA(),e.TgZ(3,"mat-select",10),e.NdJ("ngModelChange",function(n){e.CHM(t);const s=e.oxw().$implicit,l=e.oxw();return e.KtG(l.data[s.id]=n)}),e.YNc(4,L,2,2,"mat-option",11),e.qZA()()}if(2&i){const t=e.oxw().$implicit,o=e.oxw();e.xp6(2),e.Oqu(t.name),e.xp6(1),e.Q6J("name",t.id)("required",t.is_required)("ngModel",o.data[t.id]),e.xp6(1),e.Q6J("ngForOf",t.options)("ngForTrack",o.option)}}function Q(i,d){if(1&i&&(e.TgZ(0,"mat-option",12),e._uU(1),e.qZA()),2&i){const t=d.$implicit;e.Q6J("value",t.value),e.xp6(1),e.Oqu(t.value)}}function S(i,d){if(1&i){const t=e.EpF();e.TgZ(0,"mat-form-field",8)(1,"mat-label"),e._uU(2),e.qZA(),e.TgZ(3,"mat-select",13),e.NdJ("ngModelChange",function(n){e.CHM(t);const s=e.oxw().$implicit,l=e.oxw();return e.KtG(l.data[s.id]=n)}),e.YNc(4,Q,2,2,"mat-option",11),e.qZA()()}if(2&i){const t=e.oxw().$implicit,o=e.oxw();e.xp6(2),e.Oqu(t.name),e.xp6(1),e.Q6J("name",t.id)("required",t.is_required)("ngModel",o.data[t.id]),e.xp6(1),e.Q6J("ngForOf",t.options)("ngForTrack",o.option)}}function U(i,d){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,N,4,5,"mat-form-field",7),e.YNc(2,k,4,5,"mat-form-field",7),e.YNc(3,O,5,6,"mat-form-field",7),e.YNc(4,S,5,6,"mat-form-field",7),e.qZA()),2&i){const t=d.$implicit;e.Tol("long-text"===t.type?"col-md-12":"col-md-6"),e.xp6(1),e.Q6J("ngIf","text"===t.type),e.xp6(1),e.Q6J("ngIf","long-text"===t.type),e.xp6(1),e.Q6J("ngIf","select"===t.type),e.xp6(1),e.Q6J("ngIf","multi-select"===t.type)}}function K(i,d){if(1&i){const t=e.EpF();e.TgZ(0,"button",14),e.NdJ("click",function(){const s=e.CHM(t).$implicit,l=e.oxw();return e.KtG(l.onActiveStepChange(s.id))}),e._uU(1),e.qZA()}if(2&i){const t=d.$implicit,o=e.oxw();e.Gre("btn ",t.id!=o.active_step?"btn-info":"btn-light",""),e.xp6(1),e.hij(" ",t.name," ")}}function G(i,d){if(1&i){const t=e.EpF();e.TgZ(0,"mat-form-field",8)(1,"mat-label"),e._uU(2),e.qZA(),e.TgZ(3,"input",9),e.NdJ("ngModelChange",function(n){e.CHM(t);const s=e.oxw().$implicit,l=e.oxw().$implicit,r=e.oxw();return e.KtG(r.data.steps[l.id][s.id]=n)}),e.qZA()()}if(2&i){const t=e.oxw().$implicit,o=e.oxw().$implicit,n=e.oxw();e.xp6(2),e.Oqu(t.name),e.xp6(1),e.s9C("placeholder",t.name),e.Q6J("name",t.id)("required",t.is_required)("ngModel",n.data.steps[o.id][t.id])}}function Y(i,d){if(1&i){const t=e.EpF();e.TgZ(0,"mat-form-field",8)(1,"mat-label"),e._uU(2),e.qZA(),e.TgZ(3,"textarea",9),e.NdJ("ngModelChange",function(n){e.CHM(t);const s=e.oxw().$implicit,l=e.oxw().$implicit,r=e.oxw();return e.KtG(r.data.steps[l.id][s.id]=n)}),e.qZA()()}if(2&i){const t=e.oxw().$implicit,o=e.oxw().$implicit,n=e.oxw();e.xp6(2),e.Oqu(t.name),e.xp6(1),e.s9C("placeholder",t.name),e.Q6J("name",t.id)("required",t.is_required)("ngModel",n.data.steps[o.id][t.id])}}function $(i,d){if(1&i&&(e.TgZ(0,"mat-option",12),e._uU(1),e.qZA()),2&i){const t=d.$implicit;e.Q6J("value",t.value),e.xp6(1),e.Oqu(t.value)}}function H(i,d){if(1&i){const t=e.EpF();e.TgZ(0,"mat-form-field",8)(1,"mat-label"),e._uU(2),e.qZA(),e.TgZ(3,"mat-select",10),e.NdJ("ngModelChange",function(n){e.CHM(t);const s=e.oxw().$implicit,l=e.oxw().$implicit,r=e.oxw();return e.KtG(r.data.steps[l.id][s.id]=n)}),e.YNc(4,$,2,2,"mat-option",11),e.qZA()()}if(2&i){const t=e.oxw().$implicit,o=e.oxw().$implicit,n=e.oxw();e.xp6(2),e.Oqu(t.name),e.xp6(1),e.Q6J("name",t.id)("required",t.is_required)("ngModel",n.data.steps[o.id][t.id]),e.xp6(1),e.Q6J("ngForOf",t.options)("ngForTrack",n.option)}}function I(i,d){if(1&i&&(e.TgZ(0,"mat-option",12),e._uU(1),e.qZA()),2&i){const t=d.$implicit;e.Q6J("value",t.value),e.xp6(1),e.Oqu(t.value)}}function P(i,d){if(1&i){const t=e.EpF();e.TgZ(0,"mat-form-field",8)(1,"mat-label"),e._uU(2),e.qZA(),e.TgZ(3,"mat-select",13),e.NdJ("ngModelChange",function(n){e.CHM(t);const s=e.oxw().$implicit,l=e.oxw().$implicit,r=e.oxw();return e.KtG(r.data.steps[l.id][s.id]=n)}),e.YNc(4,I,2,2,"mat-option",11),e.qZA()()}if(2&i){const t=e.oxw().$implicit,o=e.oxw().$implicit,n=e.oxw();e.xp6(2),e.Oqu(t.name),e.xp6(1),e.Q6J("name",t.id)("required",t.is_required)("ngModel",n.data.steps[o.id][t.id]),e.xp6(1),e.Q6J("ngForOf",t.options)("ngForTrack",n.option)}}function D(i,d){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,G,4,5,"mat-form-field",7),e.YNc(2,Y,4,5,"mat-form-field",7),e.YNc(3,H,5,6,"mat-form-field",7),e.YNc(4,P,5,6,"mat-form-field",7),e.qZA()),2&i){const t=d.$implicit;e.Tol("long-text"===t.type?"col-md-12":"col-md-6"),e.xp6(1),e.Q6J("ngIf","text"===t.type),e.xp6(1),e.Q6J("ngIf","long-text"===t.type),e.xp6(1),e.Q6J("ngIf","select"===t.type),e.xp6(1),e.Q6J("ngIf","multi-select"===t.type)}}const j=function(i){return{hidden_step:i}};function z(i,d){if(1&i&&(e.TgZ(0,"div",15)(1,"div",16),e.YNc(2,D,5,7,"div",3),e.qZA()()),2&i){const t=d.$implicit,o=e.oxw();e.xp6(1),e.Q6J("ngClass",e.VKq(2,j,t.id!=o.active_step)),e.xp6(1),e.Q6J("ngForOf",t.fields)}}let R=(()=>{class i{constructor(t,o,n){this.customModulesService=t,this.modalService=o,this._snackBar=n,this.isLoading=!1,this.horizontalPosition="end",this.verticalPosition="bottom",this.closingEvent=new e.vpe,this.reloadEvent=new e.vpe,this.fields=[],this.steps=[],this.active_step=null}ngOnInit(){this.data={};for(let t of this.custom_module.fields)this.data[t.id]="";this.active_step=null,this.data.steps={};for(let t of this.custom_module.steps){this.data.steps[t.id]={},this.active_step||(this.active_step=t.id);for(let o of t.fields)this.data.steps[t.id][o.id]=""}}onClose(){this.closingEvent.emit()}toggleStatus(){this.data.enabled=!this.data.enabled}onSubmit(){const t=Object.values(this.form.controls);for(let o of t)if(o.invalid)return;if(this.isLoading=!0,!this.selectedElement){let o=[],n=[];for(let l in this.data)if("steps"===l)for(let r in this.data.steps)for(let m in this.data.steps[r])n.push({module_step_id:Number(r),module_step_field_id:Number(m),value:this.data.steps[r][m]});else o.push({module_field_id:Number(l),value:this.data[l]});let s={fields:o,steps:n};console.log(n),this.customModulesService.create_elements(this.custom_module.id,s).subscribe(l=>{this.onSuccess(l)},l=>{this.onError(l)})}}onSuccess(t){this.isLoading=!1,this.reloadEvent.emit(),this.modalService.dismissAll(),this._snackBar.open("Enregistr\xe9 avec succ\xe8s!","Ok",{horizontalPosition:this.horizontalPosition,verticalPosition:this.verticalPosition,panelClass:["success-snackbar"]})}onError(t){this.isLoading=!1;let o=t.error.data;for(let n in o)this._snackBar.open(o[n],"Ok",{horizontalPosition:this.horizontalPosition,verticalPosition:this.verticalPosition,panelClass:["danger-snackbar"]})}onActiveStepChange(t){this.active_step=t}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(p.L),e.Y36(E.FF),e.Y36(h.ux))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-custom-modules-elements-form"]],viewQuery:function(t,o){if(1&t&&e.Gf(y,5),2&t){let n;e.iGM(n=e.CRH())&&(o.form=n.first)}},inputs:{selectedElement:"selectedElement",custom_module:"custom_module"},outputs:{closingEvent:"closingEvent",reloadEvent:"reloadEvent"},decls:8,vars:5,consts:[[3,"title","isLoading","closingEvent","submit"],["f","ngForm"],[1,"row"],[3,"class",4,"ngFor","ngForOf"],[1,"col-md-12","d-flex"],[3,"class","click",4,"ngFor","ngForOf"],["class","col-md-12 conatiner-fluid",4,"ngFor","ngForOf"],["class","full-width",4,"ngIf"],[1,"full-width"],["matInput","",3,"placeholder","name","required","ngModel","ngModelChange"],[3,"name","required","ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf","ngForTrack"],[3,"value"],["multiple","",3,"name","required","ngModel","ngModelChange"],[3,"click"],[1,"col-md-12","conatiner-fluid"],[1,"row",3,"ngClass"]],template:function(t,o){1&t&&(e.TgZ(0,"app-base-modal",0),e.NdJ("closingEvent",function(){return o.onClose()})("submit",function(){return o.onSubmit()}),e.TgZ(1,"form",null,1)(3,"div",2),e.YNc(4,U,5,7,"div",3),e.TgZ(5,"div",4),e.YNc(6,K,2,4,"button",5),e.qZA(),e.YNc(7,z,3,4,"div",6),e.qZA()()()),2&t&&(e.Q6J("title",o.custom_module.name)("isLoading",o.isLoading),e.xp6(4),e.Q6J("ngForOf",o.custom_module.fields),e.xp6(2),e.Q6J("ngForOf",o.custom_module.steps),e.xp6(1),e.Q6J("ngForOf",o.custom_module.steps))},dependencies:[c.mk,c.sg,c.O5,w.u,_._Y,_.Fj,_.JJ,_.JL,_.Q7,_.On,_.F,u.KE,u.hX,x.Nt,v.gD,J.ey],styles:[".hidden_step[_ngcontent-%COMP%]{display:none!important}.full-width[_ngcontent-%COMP%]{width:100%}"]}),i})();function B(i,d){if(1&i){const t=e.EpF();e.TgZ(0,"div",12)(1,"h3",13),e._uU(2),e.qZA(),e.TgZ(3,"div",14)(4,"button",15),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.onAdd())}),e._uU(5," Ajouter "),e.qZA(),e.TgZ(6,"button",16),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.exportData())}),e._uU(7," Export "),e.qZA()()()}if(2&i){const t=e.oxw();e.xp6(2),e.Oqu(t.custom_module?t.custom_module.name:"")}}function X(i,d){if(1&i){const t=e.EpF();e.TgZ(0,"app-custom-modules-elements-form",17),e.NdJ("closingEvent",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.onClose())})("reloadEvent",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.onFormReload())}),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("id",t.selectedElement)("selectedElement",t.selectedElement)("custom_module",t.custom_module)}}let V=(()=>{class i{constructor(t,o,n){this.route=t,this.customModulesService=o,this.translate=n,this.data=[],this.isShowForm=!1,this.selectedElement=null,this.page=1,this.pagesCount=1,this.isLoading=!0,this.tableData=[],this.custom_module=null,this.filters={id:""},this.filtersElements=[{type:"number",name:"id",title:"ID",value:""}]}ngOnInit(){this.onLoad()}onAdd(){this.isShowForm=!0}onClose(){this.isShowForm=!1,this.selectedElement=!1}onFormReload(){this.onClose(),this.onLoad()}toggleStatusChange(t){console.log(t.status,t.id)}onEdit(t){this.isShowForm=!0,this.selectedElement=t}onPageChange(t){console.log(t),this.page=t,this.onLoad()}onLoad(){let t=this.getFilters();console.log(t),this.route.paramMap.subscribe(o=>{this.isLoading=!0,this.customModulesService.find(o.get("id")).subscribe(n=>{this.custom_module=n.data,this.tableData=[{header:"Id",key:"id",type:"text"}];for(let s of this.custom_module.fields)s.show_in_list&&this.tableData.push({header:s.name.charAt(0).toUpperCase()+s.name.slice(1),key:"field"+s.id,type:"text"});for(let s of this.custom_module.steps)for(let l of s.fields)l.show_in_list&&this.tableData.push({header:l.name.charAt(0).toUpperCase()+l.name.slice(1),key:"step_field"+l.id,type:"text"});this.tableData.push({header:"Date de cr\xe9ation",key:"created_at",type:"date"},{header:"Date de modification",key:"updated_at",type:"date"}),this.customModulesService.all_elements(o.get("id"),{params:t}).subscribe(s=>{this.data=s.data.data.map(l=>{let r=[];for(let m of l.values)r["field"+m.field.id]=m.value;for(let m of l.step_values)r["step_field"+m.module_step_field_id]=m.value;return{id:l.id,...r,created_at:l.created_at,updated_at:l.updated_at}}),this.pagesCount=s.data.last_page,this.isLoading=!1},s=>{this.isLoading=!1})})})}exportData(){this.isLoading=!0;let t=this.getFilters(!0);this.customModulesService.all({params:t,responseType:"blob"}).subscribe(o=>{console.log(o);const n=new Blob([o],{type:"text/csv"});(0,T.saveAs)(n,"medicines.csv"),this.isLoading=!1},o=>{console.log(o),this.isLoading=!1})}getFilters(t=!1){let o={};for(let n in this.filters)this.filters[n]&&""!=this.filters[n]&&(o[n]=this.filters[n]);return o.page=this.page,t&&(o.export=!0),o}onFiltersChange(t){this.filters={...t},this.onLoad()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(g.gz),e.Y36(p.L),e.Y36(C.sK))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-custom-modules-elements-list"]],decls:12,vars:8,consts:[[1,"header","bg-gradient-info","pb-8","pt-5","pt-md-8"],[1,"container-fluid"],[1,"header-body"],[1,"container-fluid","mt--7"],[1,"row"],[1,"col"],[1,"card","shadow"],["class","card-header border-0 d-flex",4,"ngIf"],[3,"filters","onFilterChange"],[3,"tableData","data","isLoading","onEdit","onToggleStatus"],[3,"page","pagesCount","onPageChange"],[3,"id","selectedElement","custom_module","closingEvent","reloadEvent",4,"ngIf"],[1,"card-header","border-0","d-flex"],[1,"mb-0"],[1,"ml-auto"],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-success","ml-2",3,"click"],[3,"id","selectedElement","custom_module","closingEvent","reloadEvent"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e._UZ(2,"div",2),e.qZA()(),e.TgZ(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6),e.YNc(7,B,8,1,"div",7),e.TgZ(8,"app-base-filter",8),e.NdJ("onFilterChange",function(s){return o.onFiltersChange(s)}),e.qZA(),e.TgZ(9,"app-base-table",9),e.NdJ("onEdit",function(s){return o.onEdit(s)})("onToggleStatus",function(s){return o.toggleStatusChange(s)}),e.qZA(),e.TgZ(10,"app-pagination-links",10),e.NdJ("onPageChange",function(s){return o.onPageChange(s)}),e.qZA()()()()(),e.YNc(11,X,1,3,"app-custom-modules-elements-form",11)),2&t&&(e.xp6(7),e.Q6J("ngIf",!o.isLoading),e.xp6(1),e.Q6J("filters",o.filtersElements),e.xp6(1),e.Q6J("tableData",o.tableData)("data",o.data)("isLoading",o.isLoading),e.xp6(1),e.Q6J("page",o.page)("pagesCount",o.pagesCount),e.xp6(1),e.Q6J("ngIf",o.isShowForm))},dependencies:[c.O5,F.N,Z.K,b.C,R]}),i})();var f=a(136),q=a(4859),A=a(7392);const W=["f"];function ee(i,d){1&i&&(e.TgZ(0,"mat-error"),e._uU(1,"Nom est requis."),e.qZA())}function te(i,d){if(1&i&&(e.TgZ(0,"mat-option",27),e._uU(1),e.qZA()),2&i){const t=d.$implicit;e.Q6J("value",t),e.xp6(1),e.Oqu(t)}}function oe(i,d){if(1&i){const t=e.EpF();e.TgZ(0,"div",30)(1,"div",31)(2,"mat-form-field",4)(3,"mat-label"),e._uU(4,"Option"),e.qZA(),e.TgZ(5,"input",32),e.NdJ("ngModelChange",function(n){const l=e.CHM(t).index,r=e.oxw(2).index,m=e.oxw();return e.KtG(m.fields[r].options[l].value=n)}),e.qZA()(),e.TgZ(6,"button",33),e.NdJ("click",function(){const s=e.CHM(t).index,l=e.oxw(2).index,r=e.oxw();return e.KtG(r.removeOption(l,s))}),e.TgZ(7,"mat-icon"),e._uU(8,"remove"),e.qZA()()()()}if(2&i){const t=d.index,o=e.oxw(2).index,n=e.oxw();e.xp6(5),e.Q6J("ngModel",n.fields[o].options[t].value)}}function ne(i,d){if(1&i){const t=e.EpF();e.TgZ(0,"div",28)(1,"div",2)(2,"div",10)(3,"button",11),e.NdJ("click",function(){e.CHM(t);const n=e.oxw().index,s=e.oxw();return e.KtG(s.addOption(n))}),e._uU(4," Ajouter une option "),e.qZA()(),e.YNc(5,oe,9,1,"div",29),e.qZA()()}if(2&i){const t=e.oxw().$implicit;e.xp6(5),e.Q6J("ngForOf",t.options)}}function ie(i,d){if(1&i){const t=e.EpF();e.TgZ(0,"div",13)(1,"div",14)(2,"div",15)(3,"button",16),e.NdJ("click",function(){const s=e.CHM(t).index,l=e.oxw();return e.KtG(l.removeField(s))}),e.TgZ(4,"mat-icon"),e._uU(5,"clear"),e.qZA()()(),e.TgZ(6,"div",3)(7,"mat-form-field",4)(8,"mat-label"),e._uU(9,"Nom"),e.qZA(),e.TgZ(10,"input",17),e.NdJ("ngModelChange",function(n){const l=e.CHM(t).index,r=e.oxw();return e.KtG(r.fields[l].name=n)}),e.qZA()()(),e.TgZ(11,"div",3)(12,"mat-form-field",4)(13,"mat-label"),e._uU(14,"Type"),e.qZA(),e.TgZ(15,"mat-select",18),e.NdJ("ngModelChange",function(n){const l=e.CHM(t).index,r=e.oxw();return e.KtG(r.fields[l].type=n)}),e.YNc(16,te,2,2,"mat-option",19),e.qZA()()(),e.YNc(17,ne,6,1,"div",20),e.TgZ(18,"div",21)(19,"div",22)(20,"span",23),e._uU(21,"Requis:"),e.qZA(),e.TgZ(22,"label",24)(23,"input",25),e.NdJ("click",function(){const s=e.CHM(t).index,l=e.oxw();return e.KtG(l.toggleFieldCheckbox(s,"is_required"))}),e.qZA(),e._UZ(24,"span",26),e.qZA()()(),e.TgZ(25,"div",21)(26,"div",22)(27,"span",23),e._uU(28,"Afficher dans la liste:"),e.qZA(),e.TgZ(29,"label",24)(30,"input",25),e.NdJ("click",function(){const s=e.CHM(t).index,l=e.oxw();return e.KtG(l.toggleFieldCheckbox(s,"show_in_list"))}),e.qZA(),e._UZ(31,"span",26),e.qZA()()()()()}if(2&i){const t=d.$implicit,o=d.index,n=e.oxw();e.xp6(10),e.Q6J("ngModel",n.fields[o].name),e.xp6(5),e.Q6J("ngModel",n.fields[o].type),e.xp6(1),e.Q6J("ngForOf",n.types)("ngForTrack",n.antType),e.xp6(1),e.Q6J("ngIf","select"===t.type||"multi-select"===t.type),e.xp6(6),e.Q6J("checked",n.fields[o].is_required),e.xp6(7),e.Q6J("checked",n.fields[o].show_in_list)}}function se(i,d){if(1&i&&(e.TgZ(0,"mat-option",27),e._uU(1),e.qZA()),2&i){const t=d.$implicit;e.Q6J("value",t),e.xp6(1),e.Oqu(t)}}function le(i,d){if(1&i){const t=e.EpF();e.TgZ(0,"div",30)(1,"div",31)(2,"mat-form-field",4)(3,"mat-label"),e._uU(4,"Option"),e.qZA(),e.TgZ(5,"input",38),e.NdJ("ngModelChange",function(n){const l=e.CHM(t).index,r=e.oxw(2).index,m=e.oxw().index,Ce=e.oxw();return e.KtG(Ce.steps[m].fields[r].options[l].value=n)}),e.qZA()(),e.TgZ(6,"button",33),e.NdJ("click",function(){const s=e.CHM(t).index,l=e.oxw(2).index,r=e.oxw().index,m=e.oxw();return e.KtG(m.removeStepOption(r,l,s))}),e.TgZ(7,"mat-icon"),e._uU(8,"remove"),e.qZA()()()()}if(2&i){const t=d.index,o=e.oxw(2).index,n=e.oxw().index,s=e.oxw();e.xp6(5),e.Q6J("ngModel",s.steps[n].fields[o].options[t].value)}}function de(i,d){if(1&i){const t=e.EpF();e.TgZ(0,"div",28)(1,"div",2)(2,"div",10)(3,"button",11),e.NdJ("click",function(){e.CHM(t);const n=e.oxw().index,s=e.oxw().index,l=e.oxw();return e.KtG(l.addStepOption(s,n))}),e._uU(4," Ajouter une option "),e.qZA()(),e.YNc(5,le,9,1,"div",29),e.qZA()()}if(2&i){const t=e.oxw().$implicit;e.xp6(5),e.Q6J("ngForOf",t.options)}}function re(i,d){if(1&i){const t=e.EpF();e.TgZ(0,"div",13)(1,"div",14)(2,"div",15)(3,"button",16),e.NdJ("click",function(){const s=e.CHM(t).index,l=e.oxw().index,r=e.oxw();return e.KtG(r.removeStepField(l,s))}),e.TgZ(4,"mat-icon"),e._uU(5,"clear"),e.qZA()()(),e.TgZ(6,"div",3)(7,"mat-form-field",4)(8,"mat-label"),e._uU(9,"Nom"),e.qZA(),e.TgZ(10,"input",17),e.NdJ("ngModelChange",function(n){const l=e.CHM(t).index,r=e.oxw().index,m=e.oxw();return e.KtG(m.steps[r].fields[l].name=n)}),e.qZA()()(),e.TgZ(11,"div",3)(12,"mat-form-field",4)(13,"mat-label"),e._uU(14,"Type"),e.qZA(),e.TgZ(15,"mat-select",37),e.NdJ("ngModelChange",function(n){const l=e.CHM(t).index,r=e.oxw().index,m=e.oxw();return e.KtG(m.steps[r].fields[l].type=n)}),e.YNc(16,se,2,2,"mat-option",19),e.qZA()()(),e.YNc(17,de,6,1,"div",20),e.TgZ(18,"div",21)(19,"div",22)(20,"span",23),e._uU(21,"Requis:"),e.qZA(),e.TgZ(22,"label",24)(23,"input",25),e.NdJ("click",function(){const s=e.CHM(t).index,l=e.oxw().index,r=e.oxw();return e.KtG(r.toggleStepFieldCheckbox(l,s,"is_required"))}),e.qZA(),e._UZ(24,"span",26),e.qZA()()(),e.TgZ(25,"div",21)(26,"div",22)(27,"span",23),e._uU(28,"Afficher dans la liste:"),e.qZA(),e.TgZ(29,"label",24)(30,"input",25),e.NdJ("click",function(){const s=e.CHM(t).index,l=e.oxw().index,r=e.oxw();return e.KtG(r.toggleStepFieldCheckbox(l,s,"show_in_list"))}),e.qZA(),e._UZ(31,"span",26),e.qZA()()()()()}if(2&i){const t=d.$implicit,o=d.index,n=e.oxw().index,s=e.oxw();e.xp6(10),e.Q6J("ngModel",s.steps[n].fields[o].name),e.xp6(5),e.Q6J("ngModel",s.steps[n].fields[o].type),e.xp6(1),e.Q6J("ngForOf",s.types)("ngForTrack",s.antType),e.xp6(1),e.Q6J("ngIf","select"===t.type||"multi-select"===t.type),e.xp6(6),e.Q6J("checked",s.steps[n].fields[o].is_required),e.xp6(7),e.Q6J("checked",s.steps[n].fields[o].show_in_list)}}function ae(i,d){if(1&i){const t=e.EpF();e.TgZ(0,"div",13)(1,"div",14)(2,"div",15)(3,"button",34),e.NdJ("click",function(){const s=e.CHM(t).index,l=e.oxw();return e.KtG(l.removeStep(s))}),e.TgZ(4,"mat-icon"),e._uU(5,"clear"),e.qZA()()(),e.TgZ(6,"div",3)(7,"mat-form-field",4)(8,"mat-label"),e._uU(9,"Nom"),e.qZA(),e.TgZ(10,"input",35),e.NdJ("ngModelChange",function(n){const l=e.CHM(t).index,r=e.oxw();return e.KtG(r.steps[l].name=n)}),e.qZA()()(),e.TgZ(11,"div",3)(12,"mat-form-field",4)(13,"mat-label"),e._uU(14,"Ordre"),e.qZA(),e.TgZ(15,"input",36),e.NdJ("ngModelChange",function(n){const l=e.CHM(t).index,r=e.oxw();return e.KtG(r.steps[l].order=n)}),e.qZA()()(),e.TgZ(16,"div",10)(17,"button",11),e.NdJ("click",function(){const s=e.CHM(t).index,l=e.oxw();return e.KtG(l.addStepField(s))}),e._uU(18," Ajouter un champ "),e.qZA()(),e.YNc(19,re,32,7,"div",12),e.qZA()()}if(2&i){const t=d.$implicit,o=d.index,n=e.oxw();e.xp6(10),e.Q6J("ngModel",n.steps[o].name),e.xp6(5),e.Q6J("ngModel",n.steps[o].order),e.xp6(4),e.Q6J("ngForOf",t.fields)}}let me=(()=>{class i{constructor(t,o,n){this.customModulesService=t,this.modalService=o,this._snackBar=n,this.title=f._G.CUSTOM_MODULES,this.types=f.HK,this.isLoading=!1,this.horizontalPosition="end",this.verticalPosition="bottom",this.closingEvent=new e.vpe,this.reloadEvent=new e.vpe,this.fields=[],this.steps=[]}ngOnInit(){this.title=(this.selectedElement?f._G.UPDATE_ELEMENT:f._G.CREATE_ELEMENT)+" "+this.title,this.data={name:this.selectedElement?this.selectedElement.name:"",icon:this.selectedElement?this.selectedElement.icon:""}}onClose(){this.closingEvent.emit()}toggleStatus(){this.data.enabled=!this.data.enabled}onSubmit(){const t=Object.values(this.form.controls);for(let o of t)if(o.invalid)return;if(this.isLoading=!0,this.selectedElement)this.customModulesService.update(this.selectedElement.id,this.data).subscribe(o=>{this.onSuccess(o)},o=>{this.onError(o)});else{let o={...this.data,fields:this.fields,steps:this.steps};console.log(o),this.customModulesService.create(o).subscribe(n=>{this.onSuccess(n)},n=>{this.onError(n)})}}onSuccess(t){this.isLoading=!1,this.reloadEvent.emit(),this.modalService.dismissAll(),this._snackBar.open("Enregistr\xe9 avec succ\xe8s!","Ok",{horizontalPosition:this.horizontalPosition,verticalPosition:this.verticalPosition,panelClass:["success-snackbar"]})}onError(t){this.isLoading=!1;let o=t.error.data;for(let n in o)this._snackBar.open(o[n],"Ok",{horizontalPosition:this.horizontalPosition,verticalPosition:this.verticalPosition,panelClass:["danger-snackbar"]})}addField(){this.fields.push({name:"",type:"",show_in_list:!0,is_required:!0,options:[]})}removeField(t){this.fields.splice(t,1)}toggleFieldCheckbox(t,o){this.fields[t][o]=!this.fields[t][o]}addOption(t){this.fields[t].options.push({value:""})}removeOption(t,o){this.fields[t].options.splice(o,1)}addStep(){this.steps.push({name:"",order:"",fields:[]})}removeStep(t){this.steps.splice(t,1)}addStepField(t){this.steps[t].fields.push({name:"",type:"",show_in_list:!0,is_required:!0,options:[]})}removeStepField(t,o){this.steps[t].fields.splice(o,1)}addStepOption(t,o){this.steps[t].fields[o].options.push({value:""})}removeStepOption(t,o,n){this.steps[t].fields[o].options.splice(n,1)}toggleStepFieldCheckbox(t,o,n){this.steps[t].fields[o][n]=!this.steps[t].fields[o][n]}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(p.L),e.Y36(E.FF),e.Y36(h.ux))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-custom-modules-form"]],viewQuery:function(t,o){if(1&t&&e.Gf(W,5),2&t){let n;e.iGM(n=e.CRH())&&(o.form=n.first)}},inputs:{selectedElement:"selectedElement"},outputs:{closingEvent:"closingEvent",reloadEvent:"reloadEvent"},decls:27,vars:7,consts:[[3,"title","isLoading","closingEvent","submit"],["f","ngForm"],[1,"row"],[1,"col-md-6"],[1,"full-width"],["matInput","","placeholder","Nom","name","name","required","",3,"ngModel","ngModelChange"],["name","ngModel"],[4,"ngIf"],["matInput","","placeholder","Icon","name","icon",3,"ngModel","ngModelChange"],["icon","ngModel"],[1,"col-12","text-right"],["type","button",1,"btn","btn-primary",3,"click"],["class","col-12 container-fluid",4,"ngFor","ngForOf"],[1,"col-12","container-fluid"],[1,"row","isolated-section"],[1,"col-12","mt-2","text-right"],["type","button","mat-mini-fab","","color","warn","aria-label","Supprimer le champs",3,"click"],["matInput","","placeholder","Nom","name","field_name[]","required","",3,"ngModel","ngModelChange"],["name","field_type[]","required","",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf","ngForTrack"],["class","col-12",4,"ngIf"],[1,"col-md-6","d-flex","align-items-center"],[1,"form-group","d-flex","mb-0"],[1,"mr-2"],[1,"custom-toggle","mb-0"],["type","checkbox",3,"checked","click"],[1,"custom-toggle-slider","rounded-circle"],[3,"value"],[1,"col-12"],["class","col-4",4,"ngFor","ngForOf"],[1,"col-4"],[1,"form-group","d-flex","align-items-center"],["matInput","","placeholder","Option","name","field_option[]","required","",3,"ngModel","ngModelChange"],["type","button","mat-mini-fab","","color","warn","aria-label","Supprimer",3,"click"],["type","button","mat-mini-fab","","color","warn","aria-label","Supprimer l'etape",3,"click"],["matInput","","placeholder","Nom","name","step_name[]","required","",3,"ngModel","ngModelChange"],["type","number","matInput","","placeholder","Ordre","name","step_order[]","required","",3,"ngModel","ngModelChange"],["name","step_field_type[]","required","",3,"ngModel","ngModelChange"],["matInput","","placeholder","Option","name","step_field_option[]","required","",3,"ngModel","ngModelChange"]],template:function(t,o){if(1&t&&(e.TgZ(0,"app-base-modal",0),e.NdJ("closingEvent",function(){return o.onClose()})("submit",function(){return o.onSubmit()}),e.TgZ(1,"form",null,1)(3,"div",2)(4,"div",3)(5,"mat-form-field",4)(6,"mat-label"),e._uU(7,"Nom"),e.qZA(),e.TgZ(8,"input",5,6),e.NdJ("ngModelChange",function(s){return o.data.name=s}),e.qZA(),e.YNc(10,ee,2,0,"mat-error",7),e.qZA()(),e.TgZ(11,"div",3)(12,"mat-form-field",4)(13,"mat-label"),e._uU(14,"Icon"),e.qZA(),e.TgZ(15,"input",8,9),e.NdJ("ngModelChange",function(s){return o.data.icon=s}),e.qZA()()(),e._UZ(17,"hr"),e.TgZ(18,"div",10)(19,"button",11),e.NdJ("click",function(){return o.addField()}),e._uU(20," Ajouter un champ "),e.qZA()(),e.YNc(21,ie,32,7,"div",12),e._UZ(22,"hr"),e.TgZ(23,"div",10)(24,"button",11),e.NdJ("click",function(){return o.addStep()}),e._uU(25," Ajouter une etape "),e.qZA()(),e.YNc(26,ae,20,3,"div",12),e.qZA()()()),2&t){const n=e.MAs(9);e.Q6J("title",o.title)("isLoading",o.isLoading),e.xp6(8),e.Q6J("ngModel",o.data.name),e.xp6(2),e.Q6J("ngIf",n.invalid&&n.touched),e.xp6(5),e.Q6J("ngModel",o.data.icon),e.xp6(6),e.Q6J("ngForOf",o.fields),e.xp6(5),e.Q6J("ngForOf",o.steps)}},dependencies:[c.sg,c.O5,w.u,_._Y,_.Fj,_.wV,_.JJ,_.JL,_.Q7,_.On,_.F,u.TO,u.KE,u.hX,x.Nt,q.lW,A.Hw,v.gD,J.ey],styles:[".remove-option[_ngcontent-%COMP%]{width:20px;height:20px;display:flex;justify-content:center;align-items:center;border-radius:50%;border:none;background:#d9082f;color:#fff;margin-left:13px;cursor:pointer}.full-width[_ngcontent-%COMP%]{width:100%}.isolated-section[_ngcontent-%COMP%]{padding:10px 10px 35px 3px;margin:14px 0;border:1px solid grey;border-radius:10px}"]}),i})();function _e(i,d){if(1&i){const t=e.EpF();e.TgZ(0,"app-custom-modules-form",16),e.NdJ("closingEvent",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.onClose())})("reloadEvent",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.onFormReload())}),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("id",t.selectedElement)("selectedElement",t.selectedElement)}}const ce=[{path:"",component:(()=>{class i{constructor(t,o){this.customModulesService=t,this.translate=o,this.data=[],this.isShowForm=!1,this.selectedElement=null,this.page=1,this.pagesCount=1,this.isLoading=!0,this.tableData=[{header:"Id",key:"id",type:"text"},{header:"Nom",key:"name",type:"text"},{header:"Date de cr\xe9ation",key:"created_at",type:"date"},{header:"Date de modification",key:"updated_at",type:"date"}],this.filters={type:"",code:"",name:"",id:""},this.filtersElements=[{type:"number",name:"id",title:"ID",value:""},{type:"text",name:"name",title:"Nom",value:""}]}ngOnInit(){this.onLoad()}onAdd(){this.isShowForm=!0}onClose(){this.isShowForm=!1,this.selectedElement=!1}onFormReload(){this.onClose(),this.onLoad()}toggleStatusChange(t){console.log(t.status,t.id)}onEdit(t){this.isShowForm=!0,this.selectedElement=t}onPageChange(t){console.log(t),this.page=t,this.onLoad()}onLoad(){this.isLoading=!0;let t=this.getFilters();console.log(t),this.customModulesService.all({params:t}).subscribe(o=>{console.log(o),this.data=o.data.data,this.pagesCount=o.data.last_page,this.isLoading=!1},o=>{this.isLoading=!1})}exportData(){this.isLoading=!0;let t=this.getFilters(!0);this.customModulesService.all({params:t,responseType:"blob"}).subscribe(o=>{console.log(o);const n=new Blob([o],{type:"text/csv"});(0,T.saveAs)(n,"medicines.csv"),this.isLoading=!1},o=>{console.log(o),this.isLoading=!1})}getFilters(t=!1){let o={};for(let n in this.filters)this.filters[n]&&""!=this.filters[n]&&(o[n]=this.filters[n]);return o.page=this.page,t&&(o.export=!0),o}onFiltersChange(t){this.filters={...t},this.onLoad()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(p.L),e.Y36(C.sK))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-custom-modules-list"]],decls:19,vars:7,consts:[[1,"header","bg-gradient-info","pb-8","pt-5","pt-md-8"],[1,"container-fluid"],[1,"header-body"],[1,"container-fluid","mt--7"],[1,"row"],[1,"col"],[1,"card","shadow"],[1,"card-header","border-0","d-flex"],[1,"mb-0"],[1,"ml-auto"],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-success","ml-2",3,"click"],[3,"filters","onFilterChange"],[3,"tableData","data","isLoading","onEdit","onToggleStatus"],[3,"page","pagesCount","onPageChange"],[3,"id","selectedElement","closingEvent","reloadEvent",4,"ngIf"],[3,"id","selectedElement","closingEvent","reloadEvent"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e._UZ(2,"div",2),e.qZA()(),e.TgZ(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"h3",8),e._uU(9,"FORM DYNAMIQUE"),e.qZA(),e.TgZ(10,"div",9)(11,"button",10),e.NdJ("click",function(){return o.onAdd()}),e._uU(12," Ajouter "),e.qZA(),e.TgZ(13,"button",11),e.NdJ("click",function(){return o.exportData()}),e._uU(14," Export "),e.qZA()()(),e.TgZ(15,"app-base-filter",12),e.NdJ("onFilterChange",function(s){return o.onFiltersChange(s)}),e.qZA(),e.TgZ(16,"app-base-table",13),e.NdJ("onEdit",function(s){return o.onEdit(s)})("onToggleStatus",function(s){return o.toggleStatusChange(s)}),e.qZA(),e.TgZ(17,"app-pagination-links",14),e.NdJ("onPageChange",function(s){return o.onPageChange(s)}),e.qZA()()()()(),e.YNc(18,_e,1,2,"app-custom-modules-form",15)),2&t&&(e.xp6(15),e.Q6J("filters",o.filtersElements),e.xp6(1),e.Q6J("tableData",o.tableData)("data",o.data)("isLoading",o.isLoading),e.xp6(1),e.Q6J("page",o.page)("pagesCount",o.pagesCount),e.xp6(1),e.Q6J("ngIf",o.isShowForm))},dependencies:[c.O5,F.N,Z.K,b.C,me]}),i})()},{path:"elements/:id",component:V}];let ue=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[g.Bz.forChild(ce),g.Bz]}),i})();var pe=a(5642),fe=a(529);let ge=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[c.ez,ue,pe.K,fe.JF,_.u5,C.aw,h.ZX,u.lN,x.c,q.ot,A.Ps,v.LD]}),i})()}}]);