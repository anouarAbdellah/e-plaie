"use strict";(self.webpackChunkargon_dashboard_angular=self.webpackChunkargon_dashboard_angular||[]).push([[862],{1862:(E,g,s)=>{s.r(g),s.d(g,{MedicinesModule:()=>O});var m=s(6895),p=s(3060),h=s(7188),f=s(4327),r=s(136),e=s(4650),d=s(4463),u=s(3986),b=s(9359),y=s(1424),T=s(2953),_=s(7009),Z=s(4424),c=s(4006);const F=["f"];function A(i,l){1&i&&(e.TgZ(0,"div",24),e._uU(1," Code est requis. "),e.qZA())}function L(i,l){1&i&&(e.TgZ(0,"div",24),e._uU(1," Nom est requis. "),e.qZA())}function J(i,l){if(1&i&&(e.TgZ(0,"option",25),e._uU(1),e.qZA()),2&i){const n=l.$implicit;e.Q6J("value",n),e.xp6(1),e.Oqu(n)}}function N(i,l){1&i&&(e.TgZ(0,"div",24),e._uU(1," Type est requis. "),e.qZA())}function S(i,l){1&i&&(e.TgZ(0,"div",24),e._uU(1," Prix d'achat est requis. "),e.qZA())}function P(i,l){1&i&&(e.TgZ(0,"div",24),e._uU(1," Prix de vente est requis. "),e.qZA())}let x=(()=>{class i{constructor(n,t,o){this.medicinesService=n,this.modalService=t,this._snackBar=o,this.title=r._G.MEDICINES,this.isLoading=!1,this.types=r.eK,this.horizontalPosition="end",this.verticalPosition="bottom",this.closingEvent=new e.vpe,this.reloadEvent=new e.vpe}ngOnInit(){this.title=(this.selectedElement?r._G.UPDATE_ELEMENT:r._G.CREATE_ELEMENT)+" "+this.title,this.data={type:this.selectedElement?this.selectedElement.type:"",code:this.selectedElement?this.selectedElement.code:"",name:this.selectedElement?this.selectedElement.name:"",buying_price:this.selectedElement?this.selectedElement.buying_price:"",selling_price:this.selectedElement?this.selectedElement.selling_price:"",enabled:!this.selectedElement||this.selectedElement.enabled}}onClose(){this.closingEvent.emit()}toggleStatus(){this.data.enabled=!this.data.enabled}onSubmit(){const n=Object.values(this.form.controls);for(let t of n)if(t.invalid)return;this.isLoading=!0,this.selectedElement?this.medicinesService.update(this.selectedElement.id,this.data).subscribe(t=>{this.onSuccess(t)},t=>{this.onError(t)}):this.medicinesService.create(this.data).subscribe(t=>{this.onSuccess(t)},t=>{this.onError(t)})}onSuccess(n){this.isLoading=!1,this.reloadEvent.emit(),this.modalService.dismissAll(),this._snackBar.open("Enregistr\xe9 avec succ\xe8s!","Ok",{horizontalPosition:this.horizontalPosition,verticalPosition:this.verticalPosition,panelClass:["success-snackbar"]})}onError(n){this.isLoading=!1;let t=n.error.data;for(let o in t)this._snackBar.open(t[o],"Ok",{horizontalPosition:this.horizontalPosition,verticalPosition:this.verticalPosition,panelClass:["danger-snackbar"]})}}return i.\u0275fac=function(n){return new(n||i)(e.Y36(h.M),e.Y36(T.FF),e.Y36(_.ux))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-medicines-form"]],viewQuery:function(n,t){if(1&n&&e.Gf(F,5),2&n){let o;e.iGM(o=e.CRH())&&(t.form=o.first)}},inputs:{selectedElement:"selectedElement"},outputs:{closingEvent:"closingEvent",reloadEvent:"reloadEvent"},decls:39,vars:14,consts:[[3,"title","isLoading","closingEvent","submit"],["f","ngForm"],[1,"row"],[1,"col-md-6"],[1,"form-group"],["type","text","name","code","required","","placeholder","Code",1,"form-control","form-control-alternative",3,"ngModel","ngModelChange"],["code","ngModel"],["class","error-message",4,"ngIf"],["type","text","name","name","required","","placeholder","Nom",1,"form-control","form-control-alternative",3,"ngModel","ngModelChange"],["name","ngModel"],["name","type","required","","placeholder","Type",1,"form-control","form-control-alternative",3,"ngModel","ngModelChange"],["type","ngModel"],["value","","disabled",""],[3,"value",4,"ngFor","ngForOf"],["type","number","name","buying_price","required","","placeholder","Prix d'achat",1,"form-control","form-control-alternative",3,"ngModel","ngModelChange"],["buying_price","ngModel"],["type","number","name","selling_price","required","","placeholder","Prix de vente",1,"form-control","form-control-alternative",3,"ngModel","ngModelChange"],["selling_price","ngModel"],[1,"col-md-6","d-flex","align-items-center"],[1,"form-group","d-flex","mb-0"],[1,"mr-2"],[1,"custom-toggle","mb-0"],["type","checkbox",3,"checked","click"],[1,"custom-toggle-slider","rounded-circle"],[1,"error-message"],[3,"value"]],template:function(n,t){if(1&n&&(e.TgZ(0,"app-base-modal",0),e.NdJ("closingEvent",function(){return t.onClose()})("submit",function(){return t.onSubmit()}),e.TgZ(1,"form",null,1)(3,"div",2)(4,"div",3)(5,"div",4)(6,"input",5,6),e.NdJ("ngModelChange",function(a){return t.data.code=a}),e.qZA(),e.YNc(8,A,2,0,"div",7),e.qZA()(),e.TgZ(9,"div",3)(10,"div",4)(11,"input",8,9),e.NdJ("ngModelChange",function(a){return t.data.name=a}),e.qZA(),e.YNc(13,L,2,0,"div",7),e.qZA()(),e.TgZ(14,"div",3)(15,"div",4)(16,"select",10,11),e.NdJ("ngModelChange",function(a){return t.data.type=a}),e.TgZ(18,"option",12),e._uU(19,"Type"),e.qZA(),e.YNc(20,J,2,2,"option",13),e.qZA(),e.YNc(21,N,2,0,"div",7),e.qZA()(),e.TgZ(22,"div",3)(23,"div",4)(24,"input",14,15),e.NdJ("ngModelChange",function(a){return t.data.buying_price=a}),e.qZA(),e.YNc(26,S,2,0,"div",7),e.qZA()(),e.TgZ(27,"div",3)(28,"div",4)(29,"input",16,17),e.NdJ("ngModelChange",function(a){return t.data.selling_price=a}),e.qZA(),e.YNc(31,P,2,0,"div",7),e.qZA()(),e.TgZ(32,"div",18)(33,"div",19)(34,"span",20),e._uU(35,"Enabled:"),e.qZA(),e.TgZ(36,"label",21)(37,"input",22),e.NdJ("click",function(){return t.toggleStatus()}),e.qZA(),e._UZ(38,"span",23),e.qZA()()()()()()),2&n){const o=e.MAs(7),a=e.MAs(12),v=e.MAs(17),M=e.MAs(25),C=e.MAs(30);e.Q6J("title",t.title)("isLoading",t.isLoading),e.xp6(6),e.Q6J("ngModel",t.data.code),e.xp6(2),e.Q6J("ngIf",o.invalid&&o.touched),e.xp6(3),e.Q6J("ngModel",t.data.name),e.xp6(2),e.Q6J("ngIf",a.invalid&&a.touched),e.xp6(3),e.Q6J("ngModel",t.data.type),e.xp6(4),e.Q6J("ngForOf",t.types),e.xp6(1),e.Q6J("ngIf",v.invalid&&v.touched),e.xp6(3),e.Q6J("ngModel",t.data.buying_price),e.xp6(2),e.Q6J("ngIf",M.invalid&&M.touched),e.xp6(3),e.Q6J("ngModel",t.data.selling_price),e.xp6(2),e.Q6J("ngIf",C.invalid&&C.touched),e.xp6(6),e.Q6J("checked",t.data.enabled)}},dependencies:[m.sg,m.O5,Z.u,c._Y,c.YN,c.Kr,c.Fj,c.wV,c.EJ,c.JJ,c.JL,c.Q7,c.On,c.F]}),i})();function Q(i,l){if(1&i){const n=e.EpF();e.TgZ(0,"app-medicines-form",16),e.NdJ("closingEvent",function(){e.CHM(n);const o=e.oxw();return e.KtG(o.onClose())})("reloadEvent",function(){e.CHM(n);const o=e.oxw();return e.KtG(o.onFormReload())}),e.qZA()}if(2&i){const n=e.oxw();e.Q6J("id",n.selectedElement)("selectedElement",n.selectedElement)}}const I=[{path:"",component:(()=>{class i{constructor(n,t){this.medicinesService=n,this.translate=t,this.data=[],this.isShowForm=!1,this.selectedElement=null,this.page=1,this.pagesCount=1,this.isLoading=!0,this.tableData=[{header:"Id",key:"id",type:"text"},{header:"Type",key:"type",type:"text"},{header:"Code",key:"code",type:"text"},{header:"Nom",key:"name",type:"text"},{header:"Date de cr\xe9ation",key:"created_at",type:"date"},{header:"Date de modification",key:"updated_at",type:"date"},{header:"Status",key:"enabled",type:"status"}],this.filters={type:"",code:"",name:"",id:""},this.filtersElements=[{type:"number",name:"id",title:"ID",value:""},{type:"text",name:"code",title:"Code",value:""},{type:"text",name:"name",title:"Nom",value:""},{type:"select",name:"type",title:"Type",value:"",elements:r.eK},{type:"status",name:"enabled",title:"Activ\xe9",value:""}]}ngOnInit(){this.onLoad()}onAdd(){this.isShowForm=!0}onClose(){this.isShowForm=!1,this.selectedElement=!1}onFormReload(){this.onClose(),this.onLoad()}toggleStatusChange(n){console.log(n.status,n.id),this.isLoading=!0,this.medicinesService.status(n.id,{enabled:n.status}).subscribe(t=>{let o=this.data.findIndex(a=>a.id===n.id);o>=0&&(this.data[o].enabled=t.data.enabled),this.isLoading=!1})}onEdit(n){this.isShowForm=!0,this.selectedElement=n}onPageChange(n){console.log(n),this.page=n,this.onLoad()}onLoad(){this.isLoading=!0;let n=this.getFilters();console.log(n),this.medicinesService.all({params:n}).subscribe(t=>{console.log(t),this.data=t.data.data,this.pagesCount=t.data.last_page,this.isLoading=!1},t=>{this.isLoading=!1})}exportData(){this.isLoading=!0;let n=this.getFilters(!0);this.medicinesService.all({params:n,responseType:"blob"}).subscribe(t=>{console.log(t);const o=new Blob([t],{type:"text/csv"});(0,f.saveAs)(o,"medicines.csv"),this.isLoading=!1},t=>{console.log(t),this.isLoading=!1})}getFilters(n=!1){let t={};for(let o in this.filters)this.filters[o]&&""!=this.filters[o]&&(t[o]=this.filters[o]);return t.page=this.page,t.limit=15,n&&(t.export=!0),t}onFiltersChange(n){this.filters={...n},this.onLoad()}}return i.\u0275fac=function(n){return new(n||i)(e.Y36(h.M),e.Y36(d.sK))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-medicines-list"]],decls:19,vars:7,consts:[[1,"header","bg-gradient-info","pb-8","pt-5","pt-md-8"],[1,"container-fluid"],[1,"header-body"],[1,"container-fluid","mt--7"],[1,"row"],[1,"col"],[1,"card","shadow"],[1,"card-header","border-0","d-flex"],[1,"mb-0"],[1,"ml-auto"],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-success","ml-2",3,"click"],[3,"filters","onFilterChange"],[3,"tableData","data","isLoading","onEdit","onToggleStatus"],[3,"page","pagesCount","onPageChange"],[3,"id","selectedElement","closingEvent","reloadEvent",4,"ngIf"],[3,"id","selectedElement","closingEvent","reloadEvent"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0)(1,"div",1),e._UZ(2,"div",2),e.qZA()(),e.TgZ(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"h3",8),e._uU(9,"M\xc9DICAMENTS"),e.qZA(),e.TgZ(10,"div",9)(11,"button",10),e.NdJ("click",function(){return t.onAdd()}),e._uU(12," Ajouter "),e.qZA(),e.TgZ(13,"button",11),e.NdJ("click",function(){return t.exportData()}),e._uU(14," Export "),e.qZA()()(),e.TgZ(15,"app-base-filter",12),e.NdJ("onFilterChange",function(a){return t.onFiltersChange(a)}),e.qZA(),e.TgZ(16,"app-base-table",13),e.NdJ("onEdit",function(a){return t.onEdit(a)})("onToggleStatus",function(a){return t.toggleStatusChange(a)}),e.qZA(),e.TgZ(17,"app-pagination-links",14),e.NdJ("onPageChange",function(a){return t.onPageChange(a)}),e.qZA()()()()(),e.YNc(18,Q,1,2,"app-medicines-form",15)),2&n&&(e.xp6(15),e.Q6J("filters",t.filtersElements),e.xp6(1),e.Q6J("tableData",t.tableData)("data",t.data)("isLoading",t.isLoading),e.xp6(1),e.Q6J("page",t.page)("pagesCount",t.pagesCount),e.xp6(1),e.Q6J("ngIf",t.isShowForm))},dependencies:[m.O5,u.N,b.K,y.C,x]}),i})()}];let q=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[p.Bz.forChild(I),p.Bz]}),i})();var D=s(5642),k=s(529);let O=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[m.ez,q,D.K,k.JF,c.u5,d.aw,_.ZX]}),i})()},7188:(E,g,s)=>{s.d(g,{M:()=>f});var m=s(2340),p=s(4650),h=s(529);let f=(()=>{class r{constructor(d){this.http=d}all(d){return this.http.get(`${m.N.url}/api/medicines`,d)}update(d,u){return this.http.put(`${m.N.url}/api/medicines/${d}`,u)}create(d){return this.http.post(`${m.N.url}/api/medicines`,d)}status(d,u){return this.http.put(`${m.N.url}/api/medicines/status/${d}`,u)}find(d){return this.http.get(`${m.N.url}/api/medicines/${d}`)}}return r.\u0275fac=function(d){return new(d||r)(p.LFG(h.eN))},r.\u0275prov=p.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})()}}]);