"use strict";(self.webpackChunkargon_dashboard_angular=self.webpackChunkargon_dashboard_angular||[]).push([[322],{2322:(I,c,s)=>{s.r(c),s.d(c,{MotifsModule:()=>P});var p=s(6895),f=s(3060),d=s(2340),t=s(4650),u=s(529);let g=(()=>{class n{constructor(o){this.http=o}all(o){return this.http.get(`${d.N.url}/api/motifs`,o)}update(o,e){return this.http.put(`${d.N.url}/api/motifs/${o}`,e)}create(o){return this.http.post(`${d.N.url}/api/motifs`,o)}status(o,e){return this.http.put(`${d.N.url}/api/motifs/status/${o}`,e)}find(o){return this.http.get(`${d.N.url}/api/motifs/${o}`)}}return n.\u0275fac=function(o){return new(o||n)(t.LFG(u.eN))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var C=s(4327),m=s(136),h=s(4463),M=s(3986),E=s(9359),b=s(1424),y=s(2953),v=s(7009),T=s(4424),r=s(4006);const F=["f"];function Z(n,a){1&n&&(t.TgZ(0,"div",20),t._uU(1," Code est requis. "),t.qZA())}function L(n,a){1&n&&(t.TgZ(0,"div",20),t._uU(1," Nom est requis. "),t.qZA())}function A(n,a){if(1&n&&(t.TgZ(0,"option",21),t._uU(1),t.qZA()),2&n){const o=a.$implicit;t.Q6J("value",o),t.xp6(1),t.Oqu(o)}}function S(n,a){1&n&&(t.TgZ(0,"div",20),t._uU(1," Type est requis. "),t.qZA())}let J=(()=>{class n{constructor(o,e,i){this.motifsService=o,this.modalService=e,this._snackBar=i,this.title=m._G.MOTIFS,this.isLoading=!1,this.horizontalPosition="end",this.verticalPosition="bottom",this.types=m.px,this.closingEvent=new t.vpe,this.reloadEvent=new t.vpe}ngOnInit(){this.title=(this.selectedElement?m._G.UPDATE_ELEMENT:m._G.CREATE_ELEMENT)+" "+this.title,this.data={type:this.selectedElement?this.selectedElement.type:"",code:this.selectedElement?this.selectedElement.code:"",name:this.selectedElement?this.selectedElement.name:"",enabled:!this.selectedElement||this.selectedElement.enabled}}onClose(){this.closingEvent.emit()}toggleStatus(){this.data.enabled=!this.data.enabled}onSubmit(){const o=Object.values(this.form.controls);for(let e of o)if(e.invalid)return;this.isLoading=!0,this.selectedElement?this.motifsService.update(this.selectedElement.id,this.data).subscribe(e=>{this.onSuccess(e)},e=>{this.onError(e)}):this.motifsService.create(this.data).subscribe(e=>{this.onSuccess(e)},e=>{this.onError(e)})}onSuccess(o){this.isLoading=!1,this.reloadEvent.emit(),this.modalService.dismissAll(),this._snackBar.open("Enregistr\xe9 avec succ\xe8s!","Ok",{horizontalPosition:this.horizontalPosition,verticalPosition:this.verticalPosition,panelClass:["success-snackbar"]})}onError(o){this.isLoading=!1;let e=o.error.data;for(let i in e)this._snackBar.open(e[i],"Ok",{horizontalPosition:this.horizontalPosition,verticalPosition:this.verticalPosition,panelClass:["danger-snackbar"]})}}return n.\u0275fac=function(o){return new(o||n)(t.Y36(g),t.Y36(y.FF),t.Y36(v.ux))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-motifs-form"]],viewQuery:function(o,e){if(1&o&&t.Gf(F,5),2&o){let i;t.iGM(i=t.CRH())&&(e.form=i.first)}},inputs:{selectedElement:"selectedElement"},outputs:{closingEvent:"closingEvent",reloadEvent:"reloadEvent"},decls:29,vars:10,consts:[[3,"title","isLoading","closingEvent","submit"],["f","ngForm"],[1,"row"],[1,"col-md-6"],[1,"form-group"],["type","text","name","code","required","","placeholder","Code",1,"form-control","form-control-alternative",3,"ngModel","ngModelChange"],["code","ngModel"],["class","error-message",4,"ngIf"],["type","text","name","name","required","","placeholder","Nom",1,"form-control","form-control-alternative",3,"ngModel","ngModelChange"],["name","ngModel"],["name","type","required","","placeholder","Type",1,"form-control","form-control-alternative",3,"ngModel","ngModelChange"],["type","ngModel"],["value","","disabled",""],[3,"value",4,"ngFor","ngForOf"],[1,"col-md-6","d-flex","align-items-center"],[1,"form-group","d-flex","mb-0"],[1,"mr-2"],[1,"custom-toggle","mb-0"],["type","checkbox",3,"checked","click"],[1,"custom-toggle-slider","rounded-circle"],[1,"error-message"],[3,"value"]],template:function(o,e){if(1&o&&(t.TgZ(0,"app-base-modal",0),t.NdJ("closingEvent",function(){return e.onClose()})("submit",function(){return e.onSubmit()}),t.TgZ(1,"form",null,1)(3,"div",2)(4,"div",3)(5,"div",4)(6,"input",5,6),t.NdJ("ngModelChange",function(l){return e.data.code=l}),t.qZA(),t.YNc(8,Z,2,0,"div",7),t.qZA()(),t.TgZ(9,"div",3)(10,"div",4)(11,"input",8,9),t.NdJ("ngModelChange",function(l){return e.data.name=l}),t.qZA(),t.YNc(13,L,2,0,"div",7),t.qZA()(),t.TgZ(14,"div",3)(15,"div",4)(16,"select",10,11),t.NdJ("ngModelChange",function(l){return e.data.type=l}),t.TgZ(18,"option",12),t._uU(19,"Type"),t.qZA(),t.YNc(20,A,2,2,"option",13),t.qZA(),t.YNc(21,S,2,0,"div",7),t.qZA()(),t.TgZ(22,"div",14)(23,"div",15)(24,"span",16),t._uU(25,"Enabled:"),t.qZA(),t.TgZ(26,"label",17)(27,"input",18),t.NdJ("click",function(){return e.toggleStatus()}),t.qZA(),t._UZ(28,"span",19),t.qZA()()()()()()),2&o){const i=t.MAs(7),l=t.MAs(12),_=t.MAs(17);t.Q6J("title",e.title)("isLoading",e.isLoading),t.xp6(6),t.Q6J("ngModel",e.data.code),t.xp6(2),t.Q6J("ngIf",i.invalid&&i.touched),t.xp6(3),t.Q6J("ngModel",e.data.name),t.xp6(2),t.Q6J("ngIf",l.invalid&&l.touched),t.xp6(3),t.Q6J("ngModel",e.data.type),t.xp6(4),t.Q6J("ngForOf",e.types),t.xp6(1),t.Q6J("ngIf",_.invalid&&_.touched),t.xp6(6),t.Q6J("checked",e.data.enabled)}},dependencies:[p.sg,p.O5,T.u,r._Y,r.YN,r.Kr,r.Fj,r.EJ,r.JJ,r.JL,r.Q7,r.On,r.F]}),n})();function N(n,a){if(1&n){const o=t.EpF();t.TgZ(0,"app-motifs-form",16),t.NdJ("closingEvent",function(){t.CHM(o);const i=t.oxw();return t.KtG(i.onClose())})("reloadEvent",function(){t.CHM(o);const i=t.oxw();return t.KtG(i.onFormReload())}),t.qZA()}if(2&n){const o=t.oxw();t.Q6J("id",o.selectedElement)("selectedElement",o.selectedElement)}}const k=[{path:"",component:(()=>{class n{constructor(o,e){this.motifsService=o,this.translate=e,this.data=[],this.isShowForm=!1,this.selectedElement=null,this.page=1,this.pagesCount=1,this.isLoading=!0,this.tableData=[{header:"Id",key:"id",type:"text"},{header:"Nom",key:"name",type:"text"},{header:"Code",key:"code",type:"text"},{header:"Type",key:"type",type:"text"},{header:"Date de cr\xe9ation",key:"created_at",type:"date"},{header:"Date de modification",key:"updated_at",type:"date"},{header:"Status",key:"enabled",type:"status"}],this.filters={type:"",code:"",name:"",id:""},this.filtersElements=[{type:"number",name:"id",title:"ID",value:""},{type:"text",name:"code",title:"Code",value:""},{type:"text",name:"name",title:"Nom",value:""},{type:"select",name:"type",title:"Type",value:"",elements:m.px},{type:"status",name:"enabled",title:"Activ\xe9",value:""}]}ngOnInit(){this.onLoad()}onAdd(){this.isShowForm=!0}onClose(){this.isShowForm=!1,this.selectedElement=!1}onFormReload(){this.onClose(),this.onLoad()}toggleStatusChange(o){console.log(o.status,o.id),this.isLoading=!0,this.motifsService.status(o.id,{enabled:o.status}).subscribe(e=>{let i=this.data.findIndex(l=>l.id===o.id);i>=0&&(this.data[i].enabled=e.data.enabled),this.isLoading=!1})}onEdit(o){this.isShowForm=!0,this.selectedElement=o}onPageChange(o){console.log(o),this.page=o,this.onLoad()}onLoad(){this.isLoading=!0;let o=this.getFilters();console.log(o),this.motifsService.all({params:o}).subscribe(e=>{console.log(e),this.data=e.data.data,this.pagesCount=e.data.last_page,this.isLoading=!1},e=>{this.isLoading=!1})}exportData(){this.isLoading=!0;let o=this.getFilters(!0);this.motifsService.all({params:o,responseType:"blob"}).subscribe(e=>{console.log(e);const i=new Blob([e],{type:"text/csv"});(0,C.saveAs)(i,"motifs.csv"),this.isLoading=!1},e=>{console.log(e),this.isLoading=!1})}getFilters(o=!1){let e={};for(let i in this.filters)this.filters[i]&&""!=this.filters[i]&&(e[i]=this.filters[i]);return e.page=this.page,e.limit=15,o&&(e.export=!0),e}onFiltersChange(o){this.filters={...o},this.onLoad()}}return n.\u0275fac=function(o){return new(o||n)(t.Y36(g),t.Y36(h.sK))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-motifs-list"]],decls:19,vars:7,consts:[[1,"header","bg-gradient-info","pb-8","pt-5","pt-md-8"],[1,"container-fluid"],[1,"header-body"],[1,"container-fluid","mt--7"],[1,"row"],[1,"col"],[1,"card","shadow"],[1,"card-header","border-0","d-flex"],[1,"mb-0"],[1,"ml-auto"],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-success","ml-2",3,"click"],[3,"filters","onFilterChange"],[3,"tableData","data","isLoading","onEdit","onToggleStatus"],[3,"page","pagesCount","onPageChange"],[3,"id","selectedElement","closingEvent","reloadEvent",4,"ngIf"],[3,"id","selectedElement","closingEvent","reloadEvent"]],template:function(o,e){1&o&&(t.TgZ(0,"div",0)(1,"div",1),t._UZ(2,"div",2),t.qZA()(),t.TgZ(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"h3",8),t._uU(9,"MOTIFS"),t.qZA(),t.TgZ(10,"div",9)(11,"button",10),t.NdJ("click",function(){return e.onAdd()}),t._uU(12," Ajouter "),t.qZA(),t.TgZ(13,"button",11),t.NdJ("click",function(){return e.exportData()}),t._uU(14," Export "),t.qZA()()(),t.TgZ(15,"app-base-filter",12),t.NdJ("onFilterChange",function(l){return e.onFiltersChange(l)}),t.qZA(),t.TgZ(16,"app-base-table",13),t.NdJ("onEdit",function(l){return e.onEdit(l)})("onToggleStatus",function(l){return e.toggleStatusChange(l)}),t.qZA(),t.TgZ(17,"app-pagination-links",14),t.NdJ("onPageChange",function(l){return e.onPageChange(l)}),t.qZA()()()()(),t.YNc(18,N,1,2,"app-motifs-form",15)),2&o&&(t.xp6(15),t.Q6J("filters",e.filtersElements),t.xp6(1),t.Q6J("tableData",e.tableData)("data",e.data)("isLoading",e.isLoading),t.xp6(1),t.Q6J("page",e.page)("pagesCount",e.pagesCount),t.xp6(1),t.Q6J("ngIf",e.isShowForm))},dependencies:[p.O5,M.N,E.K,b.C,J]}),n})()}];let x=(()=>{class n{}return n.\u0275fac=function(o){return new(o||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[f.Bz.forChild(k),f.Bz]}),n})();var Q=s(5642);let P=(()=>{class n{}return n.\u0275fac=function(o){return new(o||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[p.ez,x,Q.K,u.JF,r.u5,h.aw,v.ZX]}),n})()}}]);